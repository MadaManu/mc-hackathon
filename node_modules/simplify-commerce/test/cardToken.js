var client = require("./_client-helper"),
	assert = require('assert');

describe('CardToken -', function() {

	it('should create a card token successfully', function(done) {
		client.cardtoken.create({
			card: {
				addressState: "MO",
				expMonth: "11",
				expYear: "19",
				addressCity: "OFallon",
				cvc: "123",
				number: "5120790000000083"
			}
		}, function(error, data) {
			if (error) {
				console.error(JSON.stringify(error.data));
				done(error);
			}

			assert.equal(data.id.length > 0, true, "Create a new card token should succeed");
			done();
		});
	});

	it('should find a card token successfully', function(done) {
		client.cardtoken.create({
			card: {
				addressState: "MO",
				expMonth: "11",
				expYear: "19",
				addressCity: "OFallon",
				cvc: "123",
				number: "5120790000000083"
			}
		}, function(error, data) {
			if (error) {
				console.error(JSON.stringify(error.data));
				done(error);
			}

			// Use id of newly created cardtoken to execute 'find' request
			client.cardtoken.find(data.id, function(findError, findSuccessResponse) {
				if (findError) {
					console.error(JSON.stringify(error.data));
					done(findError);
				}

				assert.equal(findSuccessResponse.id, data.id, "Find CardToken with ID '" + data.id + "' should succeed");
				done();
			});
		});
	});
});